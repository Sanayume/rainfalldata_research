--- Starting execution of xgboost_best.py ---

Standard Output:
--- ��������ʱ��� (Current Run Timestamp): 20250521_190049 ---
��Ŀ��Ŀ¼ (Project Root): f:\rainfalldata
��������Ŀ¼ (Features Input Dir): f:\rainfalldata\results\yangtze\features
��������������ڰ��� 'v1_opt_xgboost_yangtsu_20250521_190049' ����Ŀ¼�� (All outputs will be saved in subdirectories containing 'v1_opt_xgboost_yangtsu_20250521_190049')
���ڼ��س�������չƽ���� (V1)... (Loading flattened Yangtze data (V1)...)
�Ѽ��� X_flat ��״ (Loaded X_flat shape): (5288571, 100)
�Ѽ��� Y_flat_raw ��״ (Loaded Y_flat_raw shape): (5288571,)
���ڴ� f:\rainfalldata\results\yangtze\features\feature_names_yangtsu.txt ������������... (Loading feature names from f:\rainfalldata\results\yangtze\features\feature_names_yangtsu.txt...)
�Ѽ��� 100 ���������ơ�(Loaded 100 feature names.)
����Ԥ��������... (Preprocessing data...)
���ڽ����ݷָ�Ϊѵ�����Ͳ��Լ�... (Splitting data into training and testing sets...)
ѵ������״ (Training set shape): X=(4230856, 100), y=(4230856,)
���Լ���״ (Test set shape): X=(1057715, 100), y=(1057715,)
ѵ�����ֲ� (Train distribution): No Rain=1618613, Rain=2612243
���Լ��ֲ� (Test distribution): No Rain=404654, Rain=653061
���ڶ��岢ѵ�� XGBoost ģ�� (�������� V1 ����, Optuna �Ż�����)...
(Defining and training XGBoost model (Yangtze V1 features, Optuna optimized parameters)...)
����õ��� scale_pos_weight (����ѵ����): 0.6196 (Calculated scale_pos_weight (from training set))
����ʹ�õ�ģ�Ͳ��� (Final model parameters used): 
{'objective': 'binary:logistic', 'eval_metric': ['logloss', 'auc'], 'tree_method': 'hist', 'random_state': 42, 'early_stopping_rounds': 30, 'device': 'cuda', 'n_estimators': 2582, 'learning_rate': 0.03480882479433697, 'max_depth': 17, 'subsample': 0.9273230022264735, 'colsample_bytree': 0.850202469493706, 'gamma': 0.1252469721920858, 'lambda': 4.346099670573116e-05, 'alpha': 1.3767826511091745e-06, 'use_label_encoder': False, 'scale_pos_weight': np.float64(0.6196257392593262)}
��ʼģ��ѵ��... (Starting model training...)
[0]	validation_0-logloss:0.66987	validation_0-auc:0.95276	validation_1-logloss:0.67109	validation_1-auc:0.92826
[50]	validation_0-logloss:0.25486	validation_0-auc:0.98098	validation_1-logloss:0.29473	validation_1-auc:0.96327
[100]	validation_0-logloss:0.18004	validation_0-auc:0.98803	validation_1-logloss:0.23611	validation_1-auc:0.96910
[150]	validation_0-logloss:0.15488	validation_0-auc:0.99151	validation_1-logloss:0.21754	validation_1-auc:0.97252
[200]	validation_0-logloss:0.13844	validation_0-auc:0.99388	validation_1-logloss:0.20536	validation_1-auc:0.97538
[250]	validation_0-logloss:0.12522	validation_0-auc:0.99560	validation_1-logloss:0.19589	validation_1-auc:0.97761
[300]	validation_0-logloss:0.11337	validation_0-auc:0.99692	validation_1-logloss:0.18791	validation_1-auc:0.97939
[350]	validation_0-logloss:0.10381	validation_0-auc:0.99778	validation_1-logloss:0.18194	validation_1-auc:0.98062
[400]	validation_0-logloss:0.09558	validation_0-auc:0.99835	validation_1-logloss:0.17682	validation_1-auc:0.98162
[450]	validation_0-logloss:0.08940	validation_0-auc:0.99873	validation_1-logloss:0.17301	validation_1-auc:0.98234
[500]	validation_0-logloss:0.08334	validation_0-auc:0.99903	validation_1-logloss:0.16917	validation_1-auc:0.98306
[550]	validation_0-logloss:0.07759	validation_0-auc:0.99927	validation_1-logloss:0.16570	validation_1-auc:0.98368
[600]	validation_0-logloss:0.07281	validation_0-auc:0.99944	validation_1-logloss:0.16289	validation_1-auc:0.98416
[650]	validation_0-logloss:0.06871	validation_0-auc:0.99957	validation_1-logloss:0.16076	validation_1-auc:0.98452
[700]	validation_0-logloss:0.06455	validation_0-auc:0.99967	validation_1-logloss:0.15842	validation_1-auc:0.98491
[750]	validation_0-logloss:0.06068	validation_0-auc:0.99975	validation_1-logloss:0.15626	validation_1-auc:0.98526
[800]	validation_0-logloss:0.05732	validation_0-auc:0.99981	validation_1-logloss:0.15442	validation_1-auc:0.98556
[850]	validation_0-logloss:0.05453	validation_0-auc:0.99985	validation_1-logloss:0.15286	validation_1-auc:0.98580
[900]	validation_0-logloss:0.05171	validation_0-auc:0.99988	validation_1-logloss:0.15130	validation_1-auc:0.98605
[950]	validation_0-logloss:0.04917	validation_0-auc:0.99991	validation_1-logloss:0.15002	validation_1-auc:0.98625
[1000]	validation_0-logloss:0.04696	validation_0-auc:0.99993	validation_1-logloss:0.14888	validation_1-auc:0.98643
[1050]	validation_0-logloss:0.04474	validation_0-auc:0.99994	validation_1-logloss:0.14784	validation_1-auc:0.98658
[1100]	validation_0-logloss:0.04235	validation_0-auc:0.99996	validation_1-logloss:0.14658	validation_1-auc:0.98678
[1150]	validation_0-logloss:0.04022	validation_0-auc:0.99997	validation_1-logloss:0.14546	validation_1-auc:0.98695
[1200]	validation_0-logloss:0.03848	validation_0-auc:0.99997	validation_1-logloss:0.14467	validation_1-auc:0.98707
[1250]	validation_0-logloss:0.03685	validation_0-auc:0.99998	validation_1-logloss:0.14394	validation_1-auc:0.98717
[1300]	validation_0-logloss:0.03523	validation_0-auc:0.99998	validation_1-logloss:0.14329	validation_1-auc:0.98727
[1350]	validation_0-logloss:0.03368	validation_0-auc:0.99999	validation_1-logloss:0.14253	validation_1-auc:0.98739
[1400]	validation_0-logloss:0.03232	validation_0-auc:0.99999	validation_1-logloss:0.14192	validation_1-auc:0.98748
[1450]	validation_0-logloss:0.03087	validation_0-auc:0.99999	validation_1-logloss:0.14125	validation_1-auc:0.98759
[1500]	validation_0-logloss:0.02949	validation_0-auc:0.99999	validation_1-logloss:0.14060	validation_1-auc:0.98769
[1550]	validation_0-logloss:0.02816	validation_0-auc:0.99999	validation_1-logloss:0.13997	validation_1-auc:0.98779
[1600]	validation_0-logloss:0.02712	validation_0-auc:1.00000	validation_1-logloss:0.13950	validation_1-auc:0.98786
[1650]	validation_0-logloss:0.02598	validation_0-auc:1.00000	validation_1-logloss:0.13896	validation_1-auc:0.98795
[1700]	validation_0-logloss:0.02502	validation_0-auc:1.00000	validation_1-logloss:0.13858	validation_1-auc:0.98801
[1750]	validation_0-logloss:0.02405	validation_0-auc:1.00000	validation_1-logloss:0.13814	validation_1-auc:0.98808
[1800]	validation_0-logloss:0.02320	validation_0-auc:1.00000	validation_1-logloss:0.13775	validation_1-auc:0.98815
[1850]	validation_0-logloss:0.02228	validation_0-auc:1.00000	validation_1-logloss:0.13734	validation_1-auc:0.98822
[1900]	validation_0-logloss:0.02153	validation_0-auc:1.00000	validation_1-logloss:0.13702	validation_1-auc:0.98827
[1950]	validation_0-logloss:0.02085	validation_0-auc:1.00000	validation_1-logloss:0.13680	validation_1-auc:0.98831
[2000]	validation_0-logloss:0.02018	validation_0-auc:1.00000	validation_1-logloss:0.13648	validation_1-auc:0.98837
[2050]	validation_0-logloss:0.01959	validation_0-auc:1.00000	validation_1-logloss:0.13622	validation_1-auc:0.98841
[2100]	validation_0-logloss:0.01909	validation_0-auc:1.00000	validation_1-logloss:0.13600	validation_1-auc:0.98845
[2150]	validation_0-logloss:0.01861	validation_0-auc:1.00000	validation_1-logloss:0.13576	validation_1-auc:0.98849
[2200]	validation_0-logloss:0.01818	validation_0-auc:1.00000	validation_1-logloss:0.13560	validation_1-auc:0.98852
[2250]	validation_0-logloss:0.01773	validation_0-auc:1.00000	validation_1-logloss:0.13545	validation_1-auc:0.98855
[2300]	validation_0-logloss:0.01741	validation_0-auc:1.00000	validation_1-logloss:0.13535	validation_1-auc:0.98857
[2350]	validation_0-logloss:0.01712	validation_0-auc:1.00000	validation_1-logloss:0.13524	validation_1-auc:0.98860
[2400]	validation_0-logloss:0.01687	validation_0-auc:1.00000	validation_1-logloss:0.13512	validation_1-auc:0.98862
[2428]	validation_0-logloss:0.01684	validation_0-auc:1.00000	validation_1-logloss:0.13513	validation_1-auc:0.98862
ѵ����ɣ���ʱ 841.66 �롣(Training complete in 841.66 seconds.)
��ѵ������� (Best iteration): 2398
��ѷ��� (���Լ� logloss) (Best score (test logloss)): 0.9886

--- ���ڻ���ѵ����ʷ (v1_opt_xgboost_yangtsu_20250521_190049) (Plotting Training History) ---
ѵ����ʷͼ�ѱ�����: f:\rainfalldata\results\yangtze\plots\v1_opt_xgboost_yangtsu_20250521_190049\xgboost_yangtsu_v1_opt_xgboost_yangtsu_20250521_190049_training_history.png (Training history plot saved)

--- ������Ҫ�� (v1_opt_xgboost_yangtsu_20250521_190049) (Feature Importances) ---
Top 10 ���� (Top 10 Features):
                Feature  Importance
23   lag_1_values_GSMAP    0.360407
47  diff_1_values_GSMAP    0.175482
17      season_onehot_2    0.101601
4      raw_values_GSMAP    0.073175
25           lag_1_mean    0.010442
13              sin_day    0.008625
14              cos_day    0.008161
16      season_onehot_1    0.007017
15      season_onehot_0    0.006429
18      season_onehot_3    0.006202
����������Ҫ���ѱ�����CSV: f:\rainfalldata\results\yangtze\performance_reports\v1_opt_xgboost_yangtsu_20250521_190049\xgboost_yangtsu_v1_opt_xgboost_yangtsu_20250521_190049_feature_importances_full.csv (Full feature importances saved to CSV)
������Ҫ��ͼ�ѱ�����: f:\rainfalldata\results\yangtze\plots\v1_opt_xgboost_yangtsu_20250521_190049\xgboost_yangtsu_v1_opt_xgboost_yangtsu_20250521_190049_feature_importance.png (Feature importance plot saved)

--- �ڲ��Լ�������ģ�� (v1_opt_xgboost_yangtsu_20250521_190049) (Evaluating Model on Test Set) ---
Ԥ�����ѱ�����: f:\rainfalldata\results\yangtze\predictions\v1_opt_xgboost_yangtsu_20250521_190049\xgboost_yangtsu_v1_opt_xgboost_yangtsu_20250521_190049_test_proba_predictions.npy (Predictions saved)

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.10) ���ܱ��� ---
�������� (Confusion Matrix):
[[326621  78033]
 [  7467 645594]]
  ��ȷ���� (TN): 326621, �������� (FP): 78033
  ������ (FN): 7467, ��ȷ���� (TP): 645594
׼ȷ�� (Accuracy): 0.9192, ������ (POD): 0.9886, �ձ��� (FAR): 0.1078, �ٽ�ɹ�ָ�� (CSI): 0.8831

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.15) ���ܱ��� ---
�������� (Confusion Matrix):
[[344289  60365]
 [ 11228 641833]]
  ��ȷ���� (TN): 344289, �������� (FP): 60365
  ������ (FN): 11228, ��ȷ���� (TP): 641833
׼ȷ�� (Accuracy): 0.9323, ������ (POD): 0.9828, �ձ��� (FAR): 0.0860, �ٽ�ɹ�ָ�� (CSI): 0.8996

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.20) ���ܱ��� ---
�������� (Confusion Matrix):
[[355515  49139]
 [ 14857 638204]]
  ��ȷ���� (TN): 355515, �������� (FP): 49139
  ������ (FN): 14857, ��ȷ���� (TP): 638204
׼ȷ�� (Accuracy): 0.9395, ������ (POD): 0.9773, �ձ��� (FAR): 0.0715, �ٽ�ɹ�ָ�� (CSI): 0.9089

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.25) ���ܱ��� ---
�������� (Confusion Matrix):
[[363144  41510]
 [ 18462 634599]]
  ��ȷ���� (TN): 363144, �������� (FP): 41510
  ������ (FN): 18462, ��ȷ���� (TP): 634599
׼ȷ�� (Accuracy): 0.9433, ������ (POD): 0.9717, �ձ��� (FAR): 0.0614, �ٽ�ɹ�ָ�� (CSI): 0.9137

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.30) ���ܱ��� ---
�������� (Confusion Matrix):
[[369036  35618]
 [ 21989 631072]]
  ��ȷ���� (TN): 369036, �������� (FP): 35618
  ������ (FN): 21989, ��ȷ���� (TP): 631072
׼ȷ�� (Accuracy): 0.9455, ������ (POD): 0.9663, �ձ��� (FAR): 0.0534, �ٽ�ɹ�ָ�� (CSI): 0.9164

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.35) ���ܱ��� ---
�������� (Confusion Matrix):
[[373622  31032]
 [ 25547 627514]]
  ��ȷ���� (TN): 373622, �������� (FP): 31032
  ������ (FN): 25547, ��ȷ���� (TP): 627514
׼ȷ�� (Accuracy): 0.9465, ������ (POD): 0.9609, �ձ��� (FAR): 0.0471, �ٽ�ɹ�ָ�� (CSI): 0.9173

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.40) ���ܱ��� ---
�������� (Confusion Matrix):
[[377412  27242]
 [ 29150 623911]]
  ��ȷ���� (TN): 377412, �������� (FP): 27242
  ������ (FN): 29150, ��ȷ���� (TP): 623911
׼ȷ�� (Accuracy): 0.9467, ������ (POD): 0.9554, �ձ��� (FAR): 0.0418, �ٽ�ɹ�ָ�� (CSI): 0.9171

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.45) ���ܱ��� ---
�������� (Confusion Matrix):
[[380538  24116]
 [ 32801 620260]]
  ��ȷ���� (TN): 380538, �������� (FP): 24116
  ������ (FN): 32801, ��ȷ���� (TP): 620260
׼ȷ�� (Accuracy): 0.9462, ������ (POD): 0.9498, �ձ��� (FAR): 0.0374, �ٽ�ɹ�ָ�� (CSI): 0.9159

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.50) ���ܱ��� ---
�������� (Confusion Matrix):
[[383374  21280]
 [ 36734 616327]]
  ��ȷ���� (TN): 383374, �������� (FP): 21280
  ������ (FN): 36734, ��ȷ���� (TP): 616327
׼ȷ�� (Accuracy): 0.9452, ������ (POD): 0.9438, �ձ��� (FAR): 0.0334, �ٽ�ɹ�ָ�� (CSI): 0.9140

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.55) ���ܱ��� ---
�������� (Confusion Matrix):
[[385894  18760]
 [ 41021 612040]]
  ��ȷ���� (TN): 385894, �������� (FP): 18760
  ������ (FN): 41021, ��ȷ���� (TP): 612040
׼ȷ�� (Accuracy): 0.9435, ������ (POD): 0.9372, �ձ��� (FAR): 0.0297, �ٽ�ɹ�ָ�� (CSI): 0.9110

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.60) ���ܱ��� ---
�������� (Confusion Matrix):
[[388207  16447]
 [ 45486 607575]]
  ��ȷ���� (TN): 388207, �������� (FP): 16447
  ������ (FN): 45486, ��ȷ���� (TP): 607575
׼ȷ�� (Accuracy): 0.9414, ������ (POD): 0.9303, �ձ��� (FAR): 0.0264, �ٽ�ɹ�ָ�� (CSI): 0.9075

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.65) ���ܱ��� ---
�������� (Confusion Matrix):
[[390271  14383]
 [ 50517 602544]]
  ��ȷ���� (TN): 390271, �������� (FP): 14383
  ������ (FN): 50517, ��ȷ���� (TP): 602544
׼ȷ�� (Accuracy): 0.9386, ������ (POD): 0.9226, �ձ��� (FAR): 0.0233, �ٽ�ɹ�ָ�� (CSI): 0.9028

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049, ��ֵ 0.70) ���ܱ��� ---
�������� (Confusion Matrix):
[[392189  12465]
 [ 55973 597088]]
  ��ȷ���� (TN): 392189, �������� (FP): 12465
  ������ (FN): 55973, ��ȷ���� (TP): 597088
׼ȷ�� (Accuracy): 0.9353, ������ (POD): 0.9143, �ձ��� (FAR): 0.0204, �ٽ�ɹ�ָ�� (CSI): 0.8972

--- XGBoost (v1_opt_xgboost_yangtsu_20250521_190049) ��ͬ��ֵ�µ����� (���Լ�) ---
(Performance across different thresholds (Test Set) for v1_opt_xgboost_yangtsu_20250521_190049)
                                                   accuracy  ...     fn
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9192  ...   7467
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9323  ...  11228
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9395  ...  14857
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9433  ...  18462
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9455  ...  21989
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9465  ...  25547
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9467  ...  29150
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9462  ...  32801
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9452  ...  36734
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9435  ...  41021
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9414  ...  45486
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9386  ...  50517
XGB_v1_opt_xgboost_yangtsu_20250521_190049_Thr_...   0.9353  ...  55973

[13 rows x 6 columns]
���ڽ���ֵ���ܱ��񱣴��� f:\rainfalldata\results\yangtze\performance_reports\v1_opt_xgboost_yangtsu_20250521_190049\xgboost_yangtsu_v1_opt_xgboost_yangtsu_20250521_190049_threshold_performance.csv (Saving threshold performance table)

���ڽ�ѵ���õ�ģ�ͱ����� f:\rainfalldata\results\yangtze\models\v1_opt_xgboost_yangtsu_20250521_190049\xgboost_yangtsu_v1_opt_xgboost_yangtsu_20250521_190049_model.joblib... (Saving the trained model)
ģ�ͱ���ɹ���(Model saved successfully.)

�ű�ִ����ϡ�(Script finished.)

Standard Error:
F:\Dev\python312\Lib\site-packages\xgboost\core.py:158: UserWarning: [19:00:56] WARNING: C:\buildkite-agent\builds\buildkite-windows-cpu-autoscaling-group-i-08cbc0333d8d4aae1-1\xgboost\xgboost-ci-windows\src\learner.cc:740: 
Parameters: { "use_label_encoder" } are not used.

  warnings.warn(smsg, UserWarning)
F:\Dev\python312\Lib\site-packages\xgboost\core.py:158: UserWarning: [19:14:54] WARNING: C:\buildkite-agent\builds\buildkite-windows-cpu-autoscaling-group-i-08cbc0333d8d4aae1-1\xgboost\xgboost-ci-windows\src\common\error_msg.cc:58: Falling back to prediction using DMatrix due to mismatched devices. This might lead to higher memory usage and slower performance. XGBoost is running on: cuda:0, while the input data is on: cpu.
Potential solutions:
- Use a data structure that matches the device ordinal in the booster.
- Set the device for booster before call to inplace_predict.

This warning will only be shown once.

  warnings.warn(smsg, UserWarning)

--- Finished execution of xgboost_best.py (return code: 0) ---

